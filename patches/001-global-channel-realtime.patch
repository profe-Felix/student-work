*** Begin Patch
*** Update File: src/lib/realtime.ts
@@
-import { supabase } from './supabaseClient';
+import { supabase } from './supabaseClient';
+
+// NEW: A tiny, assignment-agnostic channel to tell students to switch assignments.
+export function globalChannel() {
+  return supabase.channel('global-class', {
+    config: { broadcast: { ack: true } },
+  });
+}
+
+// NEW: Teacher calls this to tell all students to move to a different assignment.
+export async function publishSetAssignment(assignmentId: string) {
+  const ch = globalChannel();
+  await ch.subscribe();
+  await ch.send({
+    type: 'broadcast',
+    event: 'set-assignment',
+    payload: { assignmentId, ts: Date.now() },
+  });
+  await supabase.removeChannel(ch);
+}
+
+// NEW: Students subscribe to this and jump when the teacher broadcasts.
+export function subscribeToGlobal(onSetAssignment: (assignmentId: string) => void) {
+  const ch = globalChannel()
+    .on('broadcast', { event: 'set-assignment' }, (msg: any) => {
+      const id = msg?.payload?.assignmentId;
+      if (typeof id === 'string' && id) onSetAssignment(id);
+    })
+    .subscribe();
+  return () => supabase.removeChannel(ch);
+}
*** End Patch
